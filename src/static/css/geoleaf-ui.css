/*!
 * GeoLeaf UI – Couche d’UI générique
 * ----------------------------------
 * - Tous les thèmes (couleurs, header, bouton de thème, zoom) sont gérés par :
 *     • geoleaf-theme.css  (variables de thème)
 *     • geoleaf-core.css   (header, bouton de thème, zoom)
 * - Ce fichier ne contient plus aucun style de thème doublon.
 * - Il sert uniquement de couche d’UI générique réutilisable (helpers, layout).
 */

/* ========================================================================== */
/* 1. Layout générique page / carte                                           */
/* ========================================================================== */

/* Conteneur principal : la page GeoLeaf occupe toute la hauteur */
.gl-page {
    display: flex;
    flex-direction: column;
    min-height: 100vh;
    background: var(--gl-color-bg-page);
    color: var(--gl-color-text-main);
    font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI",
        sans-serif;
}

/* Wrapper principal (en dessous du header) */
.gl-main {
    flex: 1;
    display: flex;
    flex-direction: column;
    position: relative;
    min-height: 0; /* Pour éviter les débordements flex */
}

/* Carte plein écran dans la zone principale */
.gl-main__map {
    position: relative;
    flex: 1;
    min-height: 0;
}

/* Map Leaflet en absolu dans son conteneur */
#geoleaf-map,
.gl-map {
    width: 100%;
    height: 100%;
    position: absolute;
    inset: 0;
}

/* ========================================================================== */
/* 2. Grilles et layout utilitaires                                           */
/* ========================================================================== */

.gl-stack {
    display: flex;
    flex-direction: column;
    gap: 0.75rem;
}

.gl-stack--row {
    flex-direction: row;
    align-items: center;
}

/* Alignements courants */
.gl-align-center {
    display: flex;
    align-items: center;
    justify-content: center;
}

.gl-align-between {
    display: flex;
    align-items: center;
    justify-content: space-between;
}

.gl-align-start {
    display: flex;
    align-items: flex-start;
}

/* Marges utilitaires (utilisées ponctuellement dans la démo) */
.gl-mt-sm {
    margin-top: 0.5rem;
}

.gl-mt-md {
    margin-top: 1rem;
}

.gl-mt-lg {
    margin-top: 1.5rem;
}

/* ========================================================================== */
/* 3. Boutons et contrôles génériques                                         */
/* ========================================================================== */

.gl-btn {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    gap: 0.35rem;

    padding: 0.4rem 0.75rem;
    border-radius: 9999px;

    border: 1px solid var(--gl-color-border-soft);
    background: var(--gl-color-bg-surface);
    color: var(--gl-color-text-main);

    font-size: 0.875rem;
    line-height: 1.2;
    font-weight: 500;

    cursor: pointer;
    text-decoration: none;

    box-shadow: var(--gl-shadow-soft);
    transition:
        background-color 150ms ease,
        border-color 150ms ease,
        box-shadow 150ms ease,
        transform 120ms ease;
}

.gl-btn:hover {
    background: var(--gl-color-bg-surface-muted);
    border-color: var(--gl-color-border-strong);
    box-shadow: var(--gl-shadow-medium);
    transform: translateY(-1px);
}

.gl-btn:active {
    transform: translateY(0);
    box-shadow: var(--gl-shadow-soft);
}

/* Variante "subtile" (moins d’ombre, moins d’accent) */
.gl-btn--subtle {
    box-shadow: none;
    background: var(--gl-color-bg-surface-muted);
}

/* Variante "accent" (utilise la couleur principale GeoLeaf) */
.gl-btn--accent {
    background: var(--gl-color-accent);
    color: var(--gl-color-text-inverse);
    border-color: transparent;
}

.gl-btn--accent:hover {
    background: var(--gl-color-accent-soft);
    color: var(--gl-color-text-main);
}

/* Amélioration de la visibilité du bouton accent en mode dark */
.gl-theme-dark .gl-btn--accent {
    background: var(--gl-color-accent);
    color: var(--gl-color-accent-contrast);
    font-weight: 600;
    border: 1px solid var(--gl-color-accent-soft);
    box-shadow: 0 2px 8px var(--gl-color-accent-soft),
                0 0 0 1px color-mix(in srgb, var(--gl-color-accent) 20%, transparent);
}

.gl-theme-dark .gl-btn--accent:hover {
    background: var(--gl-color-accent-hover);
    color: var(--gl-color-accent-contrast);
    border-color: color-mix(in srgb, var(--gl-color-accent) 30%, transparent);
    box-shadow: 0 4px 12px var(--gl-color-accent-soft),
                0 0 0 1px color-mix(in srgb, var(--gl-color-accent) 24%, transparent);
}

/* Variante "ghost" (fond transparent) */
.gl-btn--ghost {
    background: transparent;
    border-color: var(--gl-color-border-soft);
    box-shadow: none;
}

.gl-btn--ghost:hover {
    background: var(--gl-color-bg-surface-muted);
    box-shadow: var(--gl-shadow-soft);
}

/* Boutons icône seuls (ronds) */
.gl-icon-btn {
    width: 2.25rem;
    height: 2.25rem;
    padding: 0;

    border-radius: 9999px;
    display: inline-flex;
    align-items: center;
    justify-content: center;

    border: 1px solid var(--gl-color-border-soft);
    background: var(--gl-color-bg-surface);
    color: var(--gl-color-text-main);

    cursor: pointer;
    box-shadow: var(--gl-shadow-soft);

    transition:
        background-color 150ms ease,
        border-color 150ms ease,
        box-shadow 150ms ease,
        transform 120ms ease;
}

.gl-icon-btn:hover {
    background: var(--gl-color-bg-surface-muted);
    border-color: var(--gl-color-border-strong);
    box-shadow: var(--gl-shadow-medium);
    transform: translateY(-1px);
}

.gl-icon-btn:active {
    transform: translateY(0);
    box-shadow: var(--gl-shadow-soft);
}

/* État "actif" pour les boutons de basemap, filtres, etc. */
.gl-btn--active,
.gl-icon-btn--active {
    background: var(--gl-color-accent-soft);
    color: var(--gl-color-text-main);
    border-color: var(--gl-color-border-strong);
}

/* ========================================================================== */
/* 4. Cartes / panneaux flottants                                             */
/* ========================================================================== */

.gl-panel {
    background: var(--gl-color-bg-surface);
    color: var(--gl-color-text-main);
    border-radius: 0.75rem;

    border: 1px solid var(--gl-color-border-soft);
    box-shadow: var(--gl-shadow-medium);

    padding: 0.75rem 1rem;
}

/* Panneaux en overlay (ex : panneau info en bas à droite) */
.gl-panel--overlay {
    position: absolute;
    right: 1rem;
    bottom: 1rem;
    z-index: 800;
}

/* Titre de panneau avec petite ligne subtile */
.gl-panel__title {
    font-size: 0.875rem;
    font-weight: 600;
    margin-bottom: 0.25rem;
}

.gl-panel__subtitle {
    font-size: 0.75rem;
    color: var(--gl-color-text-muted);
    margin-bottom: 0.5rem;
}

.gl-panel__divider {
    height: 1px;
    background: var(--gl-color-border-soft);
    margin: 0.5rem 0 0.75rem;
}

/* ========================================================================== */
/* 5. Badges / Tags                                                            */
/* ========================================================================== */

.gl-badge {
    display: inline-flex;
    align-items: center;
    gap: 0.25rem;

    padding: 0.2rem 0.55rem;
    border-radius: 9999px;

    font-size: 0.7rem;
    line-height: 1.1;
    font-weight: 500;

    border: 1px solid var(--gl-color-border-soft);
    background: var(--gl-color-bg-surface-muted);
    color: var(--gl-color-text-main);
}

.gl-badge__dot {
    width: 0.45rem;
    height: 0.45rem;
    border-radius: 9999px;
    background: var(--gl-color-accent);
}

/* Variante badge "muted" */
.gl-badge--muted {
    background: transparent;
    color: var(--gl-color-text-muted);
}

/* Variante badge spéciale pour les couches, filtres, etc. */
.gl-badge--layer-manager {
    font-size: 0.72rem;
    padding-inline: 0.65rem;
}

/* ========================================================================== */
/* 6. Bouton Toggle Thème (UI uniquement)                                     */
/* ========================================================================== */

.gl-theme-toggle {
    position: relative;
    width: 46px;
    height: 26px;
    border-radius: 9999px;

    border: 1px solid var(--gl-color-border-soft);
    background: var(--gl-color-theme-toggle-track);

    padding: 0;

    display: inline-flex;
    align-items: center;
    justify-content: center;

    cursor: pointer;
    box-shadow: var(--gl-shadow-soft);

    transition:
        background-color 180ms ease,
        border-color 180ms ease,
        box-shadow 180ms ease;
}

/* Bulle interne (le “bouton” qui bouge) */
.gl-theme-toggle::after {
    content: "";
    width: 20px;
    height: 20px;
    border-radius: 9999px;

    background: var(--gl-color-theme-toggle-thumb);
    position: absolute;
    left: 3px;
    top: 3px;

    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 0.9rem;

    transition:
        left 180ms ease,
        transform 180ms ease,
        background-color 180ms ease;
}

/* Icône Soleil en LIGHT */
body.gl-theme-light .gl-theme-toggle::after {
    content: "☀";
    color: var(--gl-color-accent); /* jaune soleil discret (accent) */
}

/* Icône Lune en DARK */
body.gl-theme-dark .gl-theme-toggle::after {
    content: "☾";
    color: var(--gl-color-text-muted); /* gris clair (texte atténué) */
}

/* Position ON quand dark mode activé */
body.gl-theme-dark .gl-theme-toggle::after {
    left: 23px;
    transform: translateX(0) scale(1.03);
}

/* Hover sur le toggle */
.gl-theme-toggle:hover {
    box-shadow:
        0 0 0 1px var(--gl-color-border-soft),
        var(--gl-shadow-medium);
}

/* Focus clavier accessible : halo cohérent avec le thème */
.gl-theme-toggle:focus-visible {
    outline: none;
    box-shadow:
        0 0 0 2px var(--gl-color-accent),
        0 0 0 4px var(--gl-color-bg-surface),
        var(--gl-shadow-medium);
    transition: box-shadow 180ms ease;
}

/* Pour éviter l'effet "cassé" du thème : couleur de fond du track */
body.gl-theme-light .gl-theme-toggle {
    background: var(--gl-color-theme-toggle-track);
}

body.gl-theme-dark .gl-theme-toggle {
    background: var( --gl-color-theme-toggle-track);
}

/* ------------------------------------------------------------
   LEFT PANEL – BASELAYER CONTROLS (TAB BAR STYLE)
   ------------------------------------------------------------ */

.gl-left-panel {
    position: absolute;
    top: 10px;
    left: 60px;
    z-index: 1000;
    display: inline-flex;
    flex-direction: row;
    gap: 0;
    pointer-events: auto;
    /* Use theme variables so alternate themes can override the look */
    background: var(--gl-color-overlay-strong);
    border-radius: 50px;
    padding: 6px 8px;
    box-shadow: var(--gl-shadow-medium);
    position: relative;
    --indicator-left: 8px;
    --indicator-width: 0px;
    backdrop-filter: blur(10px);
    width: fit-content;
    border: 1px solid var(--gl-color-border-soft);
}

.gl-baselayer-btn {
    position: relative;
    pointer-events: auto;
    padding: 10px 20px;
    background: transparent;
    border: none;
    font-size: 0.875rem;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.25s ease;
    /* Prefer theme aware text color for buttons sitting on overlay */
    color: var(--gl-color-text-inverse);
    white-space: nowrap;
    border-radius: 50px;
    z-index: 2;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.gl-baselayer-btn:hover:not(.gl-baselayer-active):not(.is-active) {
    background: var(--gl-color-accent-soft);
    color: var(--gl-color-text-inverse);
}

.gl-baselayer-btn.gl-baselayer-active,
.gl-baselayer-btn.is-active {
    background: var(--gl-color-accent-soft);
    color: var(--gl-color-text-inverse);
    font-weight: 600;
}

.gl-baselayer-btn:focus-visible {
    outline: 2px solid var(--gl-color-focus-ring);
    outline-offset: 2px;
}

/* ------------------------------------------------------------
   POI PANEL – ACCORDÉONS (SECTIONS REPLIABLES)
   ------------------------------------------------------------ */

/* Conteneur générique d’une section accordéon */
.gl-accordion {
    border-radius: 8px;
    background: var(--gl-color-surface-elevated);
    border: 1px solid var(--gl-color-border-subtle);
    margin-bottom: 0.5rem;
    overflow: hidden;
}

/* Bouton d’en-tête cliquable */
.gl-accordion__header {
    width: 100%;
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 0.5rem;
    padding: 0.55rem 0.75rem;
    background: transparent;
    border: none;
    cursor: pointer;
    font: inherit;
    color: inherit;
    text-align: left;
}

/* Focus clavier visible (accessibilité) */
.gl-accordion__header:focus-visible {
    outline: 2px solid var(--gl-color-focus-ring);
    outline-offset: 2px;
}

/* Titre de la section */
.gl-accordion__title {
    font-size: 0.9rem;
    font-weight: 600;
    letter-spacing: 0.01em;
    text-transform: none;
}

/* Icône d’ouverture/fermeture */
.gl-accordion__icon {
    font-size: 0.9rem;
    line-height: 1;
    transform: rotate(0deg);
    transition: transform 0.18s ease-out;
    opacity: 0.75;
}

/* Rotation de l’icône lorsque la section est ouverte */
.gl-accordion.is-open .gl-accordion__icon {
    transform: rotate(-180deg);
    opacity: 1;
}

/* Corps de l’accordéon (contenu repliable) */
.gl-accordion__body {
    max-height: 0;
    overflow: hidden;
    padding: 0 0.75rem;
    opacity: 0;
    transition:
        max-height 0.22s ease-out,
        opacity 0.18s ease-out,
        padding-top 0.18s ease-out,
        padding-bottom 0.18s ease-out;
}

/* État ouvert : le contenu devient visible */
.gl-accordion.is-open .gl-accordion__body {
    max-height: 800px; /* valeur suffisamment grande pour la plupart des contenus */
    padding-top: 0.35rem;
    padding-bottom: 0.6rem;
    opacity: 1;
}

/* Intégration harmonieuse dans le panneau POI */
.gl-poi-panel__section.gl-accordion {
    margin-bottom: 0.75rem;
}

/* ------------------------------------------------------------
   POI PANEL – CONTENU SPÉCIFIQUE (TEXTES, GALERIE, AVIS)
   ------------------------------------------------------------ */

/* Texte standard dans le panneau latéral */
.gl-poi-panel__text {
    font-size: 0.85rem;
    line-height: 1.45;
}

/* Texte long (description détaillée) */
.gl-poi-panel__text--multiline {
    white-space: normal;
}

/* Galerie photos simple pour le panneau latéral */
.gl-poi-panel__gallery {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(80px, 1fr));
    gap: 0.4rem;
}

.gl-poi-panel__gallery-item {
    margin: 0;
    padding: 0;
    border-radius: 6px;
    overflow: hidden;
    background: var(--gl-color-gallery-item-bg);
}

.gl-poi-panel__gallery-item img {
    display: block;
    width: 100%;
    height: 64px;
    object-fit: cover;
}

/* Avis voyageurs – liste verticale compacte */
.gl-poi-panel__reviews {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
}

.gl-poi-panel__review {
    padding: 0.4rem 0;
    border-bottom: 1px solid var(--gl-color-border-soft);
}

.gl-poi-panel__review:last-child {
    border-bottom: none;
}

.gl-poi-panel__review-header {
    display: flex;
    align-items: baseline;
    flex-wrap: wrap;
    gap: 0.35rem;
    margin-bottom: 0.15rem;
    font-size: 0.8rem;
}

.gl-poi-panel__review-author {
    font-weight: 600;
}

.gl-poi-panel__review-rating {
    font-weight: 600;
    opacity: 0.85;
}

.gl-poi-panel__review-source {
    font-size: 0.75rem;
    opacity: 0.8;
}

.gl-poi-panel__review-title {
    font-size: 0.83rem;
    font-weight: 600;
    margin: 0 0 0.1rem 0;
}

.gl-poi-panel__review-comment {
    font-size: 0.8rem;
    line-height: 1.4;
    margin: 0 0 0.15rem 0;
}

.gl-poi-panel__review-footer {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    font-size: 0.75rem;
    opacity: 0.8;
}

.gl-poi-panel__review-link {
    font-size: 0.75rem;
    text-decoration: underline;
}
/* ------------------------------------------------------------
   TABLEAU – HORAIRES DÉTAILLÉS (panneau latéral POI)
   Version neutre : pas de radius, pas de fond propre,
   couleurs héritées du thème (light/dark).
   ------------------------------------------------------------ */

.gl-poi-panel__table-wrapper {
    margin-top: 0.75rem;
    /* Aucun radius, aucun fond : c’est le panneau qui gère. */
    border-radius: 0;
    background: transparent;
}

/* Table de base */
.gl-poi-panel__table {
    width: 100%;
    border-collapse: collapse;
    border-spacing: 0;
    font-size: 0.85rem;
    line-height: 1.4;

    /* Couleur de bordure déléguée au thème */
    --gl-poi-table-border-color: var(--gl-panel-border, currentColor);
}

/* Bordure externe optionnelle */
.gl-poi-panel__table--border-outer {
    border: 1px solid var(--gl-poi-table-border-color);
}

/* Bordures horizontales entre lignes */
.gl-poi-panel__table--border-row .gl-poi-panel__table-row + .gl-poi-panel__table-row {
    border-top: 1px solid var(--gl-poi-table-border-color);
}

/* Bordures verticales entre colonnes */
.gl-poi-panel__table--border-column
    .gl-poi-panel__table-cell
    + .gl-poi-panel__table-cell {
    border-left: 1px solid var(--gl-poi-table-border-color);
}

/* Lignes : pas de fond spécifique, on laisse le thème faire */
.gl-poi-panel__table-row,
.gl-poi-panel__table-row--head {
    background: transparent;
}

/* Cellules : typographie héritée du thème */
.gl-poi-panel__table-cell,
.gl-poi-panel__table-cell--head,
.gl-poi-panel__table-cell--day,
.gl-poi-panel__table-cell--open,
.gl-poi-panel__table-cell--close {
    padding: 0.45rem 0.65rem;
    vertical-align: middle;
    color: inherit;
}

/* En-têtes : juste un léger renfort typographique */
.gl-poi-panel__table-cell--head {
    font-weight: 600;
    white-space: nowrap;
}

/* Colonne "Jour" légèrement renforcée, sans changer la couleur */
.gl-poi-panel__table-cell--day {
    font-weight: 500;
    white-space: nowrap;
}

/* Aucune alternance de fond, aucun radius supplémentaire */
.gl-poi-panel__table tbody .gl-poi-panel__table-row:nth-child(2n) {
    background: transparent;
}
/* ------------------------------------------------------------
   PANNEAU LATÉRAL GAUCHE – FILTRES (BANDEAU FLOTTANT)
   ------------------------------------------------------------ */
/* À AJOUTER À LA FIN DU FICHIER */

/* Conteneur principal du panneau de filtres.
   - Flottant au-dessus de la carte
   - Positionné au-dessus de la page entière
   - Affichable/masquable via la classe .is-open
   - Utilise flexbox pour s'adapter correctement
*/
#gl-filter-panel.gl-filter-panel {
    position: fixed;
    top: 0;
    left: 0;
    bottom: 0;
    z-index: 1100;

    width: min(320px, calc(100% - 2rem));
    height: 100vh;

    display: flex;
    flex-direction: column;

    background: var(--gl-color-bg-surface);
    color: var(--gl-color-text-main);
    border-right: 1px solid var(--gl-color-border-soft);
    box-shadow: var(--gl-shadow-medium);

    opacity: 0;
    transform: translateX(-110%);
    visibility: hidden;

    transition:
        opacity 160ms ease-out,
        transform 160ms ease-out,
        visibility 0ms linear 160ms;
}

/* État ouvert : le panneau glisse et devient visible */
#gl-filter-panel.gl-filter-panel.is-open {
    opacity: 1;
    transform: translateX(0);
    visibility: visible;
    transition:
        opacity 160ms ease-out,
        transform 160ms ease-out,
        visibility 0ms linear;
}

/* Décalage des contrôles Leaflet quand le panneau est ouvert */
body:has(#gl-filter-panel.is-open) .leaflet-top.leaflet-left {
    margin-left: 320px;
    transition: margin-left 160ms ease-out;
}

/* Layout interne du panneau */
.gl-filter-panel__header,
.gl-filter-panel__body,
.gl-filter-panel__footer {
    padding-inline: 1rem;
}

/* Header du panneau (titre + bouton fermer) */
.gl-filter-panel__header {
    padding-top: 0.75rem;
    padding-bottom: 0.4rem;

    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 0.75rem;

    border-bottom: 1px solid var(--gl-color-border-soft);
}

.gl-filter-panel__title {
    margin: 0;
    font-size: 0.9rem;
    font-weight: 600;
}

/* Bouton toggle avec flèche pour fermer le panneau */
.gl-filter-panel__toggle-btn {
    border: 1px solid var(--gl-color-border-soft);
    background: var(--gl-color-bg-surface);
    color: var(--gl-color-text-main);
    padding: 0.35rem 0.5rem;
    cursor: pointer;
    border-radius: 4px;
    font-size: 0.85rem;
    transition: all 120ms ease;
    display: flex;
    align-items: center;
    gap: 0.25rem;
    flex-shrink: 0;
}

.gl-filter-panel__toggle-btn:hover {
    background: var(--gl-color-bg-surface-muted);
    border-color: var(--gl-color-border-main);
}

.gl-filter-panel__toggle-icon {
    display: inline-block;
    transition: transform 120ms ease;
}

/* Masquer le bouton toggle externe quand le panneau est ouvert */
body:has(#gl-filter-panel.is-open) .gl-filter-toggle {
    display: none;
}

/* Corps : liste des groupes de filtres */
.gl-filter-panel__body {
    padding-top: 0.65rem;
    padding-bottom: 0.65rem;

    display: flex;
    flex-direction: column;
    gap: 0.65rem;

    overflow-y: auto;
    overflow-x: hidden;
    flex: 1; /* Utilise tout l'espace disponible entre header et footer */
    min-height: 0; /* Permet au flex d'ajuster correctement */
}

/* Scrollbar personnalisée (webkit) */
.gl-filter-panel__body::-webkit-scrollbar {
    width: 8px;
}

.gl-filter-panel__body::-webkit-scrollbar-track {
    background: transparent;
}

.gl-filter-panel__body::-webkit-scrollbar-thumb {
    background: var(--gl-color-border-main);
    border-radius: 4px;
    transition: background 140ms ease;
}

.gl-filter-panel__body::-webkit-scrollbar-thumb:hover {
    background: var(--gl-color-text-muted);
}

/* Groupe de filtre (label + contrôle) */
.gl-filter-panel__group {
    display: flex;
    flex-direction: column;
    gap: 0.25rem;
}

/* Label d’un filtre */
.gl-filter-panel__label {
    font-size: 0.8rem;
    font-weight: 500;
    color: var(--gl-color-text-muted);
}

/* Contrôles de base (select, input, etc.) */
.gl-filter-panel__control {
    width: 100%;
    box-sizing: border-box;
    font-size: 0.85rem;
    line-height: 1.3;

    border-radius: 999px;
    border: 1px solid var(--gl-color-border-soft);
    background: var(--gl-color-bg-surface-muted);
    color: var(--gl-color-text-main);

    padding: 0.35rem 0.7rem;

    outline: none;
    transition:
        border-color 140ms ease,
        box-shadow 140ms ease,
        background-color 140ms ease;
}

.gl-filter-panel__control:focus-visible {
    border-color: var(--gl-color-accent);
    box-shadow:
        0 0 0 1px var(--gl-color-accent),
        var(--gl-shadow-soft);
}

/* Select / multiselect */
.gl-filter-panel__control--select {
    appearance: none;
    -moz-appearance: none;
    -webkit-appearance: none;
    background-image: linear-gradient(45deg, transparent 50%, currentColor 50%),
        linear-gradient(135deg, currentColor 50%, transparent 50%);
    background-position: calc(100% - 12px) 50%, calc(100% - 7px) 50%;
    background-size: 5px 5px, 5px 5px;
    background-repeat: no-repeat;
}

/* Range + valeur visible */
.gl-filter-panel__range-wrapper {
    display: flex;
    align-items: center;
    gap: 0.5rem;
}

.gl-filter-panel__control--range {
    flex: 1;
    border-radius: 999px;
    background: transparent;
    border: none;
    padding: 0;
}

.gl-filter-panel__range-value {
    min-width: 2.2rem;
    text-align: right;
    font-size: 0.8rem;
    color: var(--gl-color-text-muted);
}

/* Tags sous forme de badges cliquables */
.gl-filter-panel__tags-container {
    display: flex;
    flex-wrap: wrap;
    gap: 0.4rem;
    padding: 0.3rem;
    box-sizing: border-box;
    width: 100%;
    min-height: 40px;
}

.gl-filter-panel__tag-badge {
    display: inline-flex;
    align-items: center;
    padding: 0.3rem 0.6rem;
    font-size: 0.75rem;
    font-weight: 500;
    border-radius: 12px;
    border: 1px solid var(--gl-color-border-soft);
    background: var(--gl-color-bg-surface-muted);
    color: var(--gl-color-text-main);
    cursor: pointer;
    user-select: none;
    transition: all 0.15s ease;
}

.gl-filter-panel__tag-badge:hover {
    background: var(--gl-color-bg-surface);
    border-color: var(--gl-color-accent);
}

.gl-filter-panel__tag-badge.is-selected {
    background: var(--gl-color-accent);
    color: var(--gl-color-text-inverse);
    border-color: var(--gl-color-accent);
}

.gl-filter-panel__tags-placeholder {
    font-size: 0.8rem;
    line-height: 1.35;
    padding: 0.45rem 0.65rem;
    border-radius: 0.5rem;
    background: var(--gl-color-bg-surface-muted);
    color: var(--gl-color-text-muted);
}

/* Footer : boutons d’action */
.gl-filter-panel__footer {
    padding-top: 0.4rem;
    padding-bottom: 0.75rem;

    display: flex;
    justify-content: flex-end;
    gap: 0.5rem;

    border-top: 1px solid var(--gl-color-border-soft);
}

.gl-filter-panel__btn-apply,
.gl-filter-panel__btn-reset {
    font-size: 0.8rem;
    padding-inline: 0.9rem;
}

/* Messages d'états du filter panel */
.gl-filter-panel__empty {
    padding: 15px;
    text-align: center;
    color: var(--gl-color-text-muted, #666);
    font-style: italic;
    font-size: 14px;
    line-height: 1.4;
}

.gl-filter-panel__error {
    padding: 15px;
    text-align: center;
    color: var(--gl-color-error, #c00);
    font-size: 14px;
    line-height: 1.4;
}

.gl-filter-panel__loading {
    padding: 15px;
    text-align: center;
    color: var(--gl-color-text-muted, #999);
    font-size: 14px;
    line-height: 1.4;
}

/* ------------------------------------------------------------
   FILTER TOGGLE BUTTON – Bouton pour ouvrir/fermer le panneau
   ------------------------------------------------------------ */
.gl-filter-toggle {
    position: fixed;
    top: calc(220px + 10%);
    left: 0;
    transform: translateY(-50%);
    z-index: 1001;

    width: 28px;
    height: 50px;

    display: flex;
    align-items: center;
    justify-content: center;

    background: var(--gl-color-bg-surface);
    border: 1px solid var(--gl-color-border-soft);
    border-left: none;
    border-radius: 0 12px 12px 0;

    cursor: pointer;
    box-shadow: var(--gl-shadow-medium);

    transition: left 160ms ease-out, background 0.2s ease, width 0.2s ease, box-shadow 0.2s ease;
}

/* Décalage du bouton toggle quand le panneau est ouvert */
body:has(#gl-filter-panel.is-open) .gl-filter-toggle {
    left: min(320px, calc(100% - 2rem));
}
.gl-filter-toggle:hover {
    background: var(--gl-color-bg-surface-muted);
    width: 32px;
    box-shadow: var(--gl-shadow-medium);
}

.gl-filter-toggle__icon {
    color: var(--gl-color-text-main);
    transition: transform 0.2s ease;
}

.gl-filter-toggle:focus-visible {
    outline: 2px solid var(--gl-color-focus-ring);
    outline-offset: 2px;
}

/* ------------------------------------------------------------
   NOUVEAUX CONTRÔLES DE FILTRES
   ------------------------------------------------------------ */

/* Checkbox Group (POI/Itinéraires) */
.gl-filter-panel__checkbox-group {
    display: flex;
    flex-direction: column;
    gap: 0.3rem;
}

.gl-filter-panel__checkbox-label {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    cursor: pointer;
    font-size: 0.85rem;
    padding: 0.2rem 0;
}

.gl-filter-panel__checkbox {
    width: 18px;
    height: 18px;
    cursor: pointer;
    accent-color: var(--gl-color-accent);
}

.gl-filter-panel__checkbox-text {
    color: var(--gl-color-text-main);
}

/* Search Input */
.gl-filter-panel__control--search {
    width: 100%;
    box-sizing: border-box;
    font-size: 0.85rem;
    padding: 0.5rem 0.7rem;
    border-radius: 6px;
    border: 1px solid var(--gl-color-border-soft);
    background: var(--gl-color-bg-surface-muted);
    color: var(--gl-color-text-main);
    outline: none;
    transition: all 0.15s ease;
}

.gl-filter-panel__control--search:focus {
    border-color: var(--gl-color-accent);
    box-shadow: 0 0 0 2px var(--gl-color-accent-alpha);
}

.gl-filter-panel__control--search::placeholder {
    color: var(--gl-color-text-muted);
    opacity: 0.6;
}

/* Tree-view (Catégories/Sous-catégories) */
.gl-filter-panel__tree {
    width: 100%;
}

.gl-filter-tree {
    list-style: none;
    margin: 0;
    padding: 0;
}

.gl-filter-tree--root {
    padding: 0;
}

.gl-filter-tree--subcategories {
    margin-top: 0.3rem;
    padding-left: 2rem;
    border-left: 2px solid var(--gl-color-border-soft);
    max-height: 0;
    overflow: hidden;
    transition: max-height 0.3s ease;
}

.gl-filter-tree__item {
    margin: 0;
    padding: 0;
    list-style: none;
}

.gl-filter-tree__item--category {
    margin-bottom: 0.2rem;
}

.gl-filter-tree__item--category.is-expanded .gl-filter-tree--subcategories {
    max-height: 1000px;
}

.gl-filter-tree__item--subcategory {
    margin-bottom: 0.15rem;
}

.gl-filter-tree__row {
    display: flex;
    align-items: center;
    gap: 0.3rem;
}

.gl-filter-tree__arrow {
    width: 16px;
    height: 16px;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    font-size: 0.7rem;
    color: var(--gl-color-text-main);
    user-select: none;
    flex-shrink: 0;
    transition: transform 0.2s ease;
}

.gl-filter-tree__arrow:hover {
    color: var(--gl-color-accent);
}

.gl-filter-tree__spacer {
    width: 16px;
    height: 16px;
    flex-shrink: 0;
}

.gl-filter-tree__label {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    cursor: pointer;
    padding: 0.2rem 0;
    font-size: 0.85rem;
    flex: 1;
}

.gl-filter-tree__label--category {
    font-weight: 600;
    color: var(--gl-color-text-main);
}

.gl-filter-tree__label--subcategory {
    font-weight: 400;
    color: var(--gl-color-text-main);
}

.gl-filter-tree__checkbox {
    width: 18px;
    height: 18px;
    cursor: pointer;
    accent-color: var(--gl-color-accent);
    flex-shrink: 0;
}

/* État indéterminé pour les catégories partiellement sélectionnées */
.gl-filter-tree__checkbox:indeterminate {
    opacity: 0.7;
}

.gl-filter-tree__text {
    user-select: none;
    flex: 1;
}

.gl-filter-panel__tree-empty {
    font-size: 0.85rem;
    color: var(--gl-color-text-muted);
    font-style: italic;
    margin: 0;
    padding: 0.5rem 0;
}

/* Proximity Filter */
.gl-filter-panel__proximity {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
}

.gl-filter-panel__proximity-title {
    font-size: 0.875rem;
    font-weight: 600;
    color: var(--gl-color-text-main);
    margin: 0;
    padding-bottom: 0.25rem;
}

.gl-filter-panel__proximity-btn {
    width: 100%;
    padding: 0.5rem;
    font-size: 0.85rem;
    transition: all 0.2s ease;
}

.gl-filter-panel__proximity-btn.is-active {
    background: var(--gl-color-accent);
    color: var(--gl-color-text-inverse);
    border-color: var(--gl-color-accent);
}

.gl-filter-panel__proximity-range {
    display: flex;
    flex-direction: column;
    gap: 0.4rem;
    padding: 0.5rem;
    background: var(--gl-color-bg-surface-muted);
    border-radius: 6px;
}

.gl-filter-panel__proximity-instruction {
    font-size: 0.75rem;
    color: var(--gl-color-text-muted);
    font-style: italic;
    margin: 0;
    padding-top: 0.3rem;
}

/* ------------------------------------------------------------
   RESPONSIVE – Sur très petits écrans, le bandeau occupe
   plus de largeur pour rester utilisable.
   ------------------------------------------------------------ */
@media (max-width: 640px) {
    #gl-filter-panel.gl-filter-panel {
        left: 0.5rem;
        right: 0.5rem;
        width: auto;
    }

    .gl-filter-toggle {
        width: 28px;
        height: 56px;
    }
}

/* Groupe de filtre avec accordéon */
.gl-filter-panel__group--accordion {
    border: 1px solid var(--gl-color-border-soft);
    border-radius: 8px;
    overflow: hidden;
    margin-bottom: 0.5rem;
}

.gl-filter-panel__accordion-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 0.6rem 0.8rem;
    background: var(--gl-color-bg-surface-muted);
    cursor: pointer;
    user-select: none;
    transition: background 0.15s ease-out;
}

.gl-filter-panel__accordion-header:hover {
    background: var(--gl-color-bg-surface);
}

.gl-filter-panel__accordion-title {
    font-size: 0.85rem;
    font-weight: 600;
    color: var(--gl-color-text-main);
    margin: 0;
}

.gl-filter-panel__accordion-arrow {
    font-size: 0.75rem;
    color: var(--gl-color-text-muted);
    transition: transform 0.2s cubic-bezier(0.4, 0, 0.2, 1);
    will-change: transform;
}

.gl-filter-panel__group--accordion.is-expanded .gl-filter-panel__accordion-arrow {
    transform: rotate(90deg);
}

.gl-filter-panel__accordion-body {
    display: grid;
    grid-template-rows: 0fr;
    overflow: hidden;
    transition: grid-template-rows 0.25s cubic-bezier(0.4, 0, 0.2, 1);
}

.gl-filter-panel__group--accordion.is-expanded .gl-filter-panel__accordion-body {
    grid-template-rows: 1fr;
}

.gl-filter-panel__accordion-body > * {
    min-height: 0;
    padding: 0;
    max-height: 300px;
    overflow-y: auto;
}

/* Scrollbar de l'accordéon (webkit) */
.gl-filter-panel__accordion-body > *::-webkit-scrollbar {
    width: 6px;
}

.gl-filter-panel__accordion-body > *::-webkit-scrollbar-track {
    background: transparent;
}

.gl-filter-panel__accordion-body > *::-webkit-scrollbar-thumb {
    background: var(--gl-color-border-soft);
    border-radius: 3px;
    transition: background 140ms ease;
}

.gl-filter-panel__accordion-body > *::-webkit-scrollbar-thumb:hover {
    background: var(--gl-color-border-main);
}

.gl-filter-panel__group--accordion.is-expanded .gl-filter-panel__accordion-body > * {
    padding: 0.8rem;
}
