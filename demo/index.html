<!DOCTYPE html>
<html lang="fr">
    <head>
        <meta charset="UTF-8" />
        <title>GeoLeaf – Démo officielle</title>
        <link rel="icon" type="image/x-icon" href="../src/static/icons/fav.png">
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />

        <!-- Cache headers managed by server in production -->

        <!-- Security Headers -->
        <meta http-equiv="Content-Security-Policy"
            content="default-src 'self';
                    script-src 'self' 'unsafe-inline' https://unpkg.com;
                    style-src 'self' 'unsafe-inline' https://unpkg.com https://fonts.googleapis.com;
                    img-src 'self' data: https: http:;
                    connect-src 'self' https: http:;
                    font-src 'self' data: https://fonts.gstatic.com;
                    object-src 'none';
                    base-uri 'self';
                    form-action 'self';">

        <meta http-equiv="X-Content-Type-Options" content="nosniff">
        <meta http-equiv="X-XSS-Protection" content="1; mode=block">
        <meta name="referrer" content="strict-origin-when-cross-origin">

        <!-- Google Fonts - Open Sans -->
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">

        <!-- Leaflet CSS -->
        <link
            rel="stylesheet"
            href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
            integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
            crossorigin=""
        />

    <!-- GeoLeaf CSS -->
    <link rel="stylesheet" href="../src/static/css/geoleaf-main.css" />
</head>
<body class="gl-theme-dark">
    <!-- Spinner CSS — masqué automatiquement par GeoLeaf.boot() via geoleaf:map:ready -->
    <div id="gl-loader"></div>

    <div class="gl-page">

        <!-- Header de dÃ©mo (chargÃ© dynamiquement depuis demo-header.html) -->
        <div id="demo-header-container"></div>

        <!-- Contenu principal -->
        <main class="gl-main">
            <!-- Toggle Dark/Light (toujours prÃ©sent, en haut Ã  droite de la carte) -->
            <button class="gl-theme-toggle gl-theme-toggle--map" data-gl-role="theme-toggle" title="Basculer thÃ¨me clair/sombre">
                <span class="gl-theme-toggle__thumb"></span>
            </button>

            <!-- Bouton toggle panneau filtres -->
            <button id="gl-filter-toggle"
                    class="gl-filter-toggle"
                    data-gl-role="filter-toggle"
                    aria-label="Ouvrir le panneau de filtres"
                    title="Filtres">
                <span class="gl-filter-toggle__icon">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none"
                    stroke="currentColor" stroke-width="6" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M9 6l6 6-6 6"></path>
                </svg>
                </span>
            </button>

            <!-- Panneau de filtres latÃ©ral -->
            <aside id="gl-filter-panel" class="gl-filter-panel" role="complementary" aria-label="Panneau de filtres">
                <!-- Le contenu sera gÃ©nÃ©rÃ© dynamiquement par GeoLeaf.UI.buildFilterPanelFromActiveProfile() -->
            </aside>

            <!-- Conteneurs pour le sÃ©lecteur de thÃ¨mes -->
            <div id="gl-theme-primary-container"></div>
            <div id="gl-theme-secondary-container"></div>

            <!-- Carte Leaflet -->
            <div id="geoleaf-map" class="gl-map"></div>
        </main>

        </div>

        <!-- Leaflet JS -->
        <script
            src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
            integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
            crossorigin=""
        ></script>

        <!-- Clustering optionnel (MarkerCluster) -->
        <script src="https://unpkg.com/leaflet.markercluster@1.5.3/dist/leaflet.markercluster.js"></script>
        <link
            rel="stylesheet"
            href="https://unpkg.com/leaflet.markercluster@1.5.3/dist/MarkerCluster.css"
        />
        <link
            rel="stylesheet"
            href="https://unpkg.com/leaflet.markercluster@1.5.3/dist/MarkerCluster.Default.css"
        />

        <!-- GeoLeaf JS - Bundle unique (remplace main.js + 150 fichiers individuels) -->
        <script src="../dist/geoleaf.umd.js"></script>

        <!-- Plugins optionnels (charger AVANT GeoLeaf.boot()) -->
        <script src="../dist/geoleaf-storage.plugin.js"></script>
        <script src="../dist/geoleaf-addpoi.plugin.js"></script>



        <!-- Charger le header de démo dynamiquement -->
        <script>
            fetch('demo-header.html')
                .then(response => response.text())
                .then(html => {
                    document.getElementById('demo-header-container').innerHTML = html;
                })
                .catch(err => console.error('Erreur chargement header:', err));
        </script>

        <!-- JS spécifique à la démo -->
        <script src="demo.extensions.js"></script>

        <!-- Bootstrap GeoLeaf -->
        <script>GeoLeaf.boot();</script>
    </body>
</html>
